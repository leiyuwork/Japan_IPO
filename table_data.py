import pandas as pd  # excel data操作要パッケージを導入
import time

for i in ["6189", "4824", "9399", "4596", "4784", "4800", "8626", "8889", "4849", "4740", "8473", "4296", "4759",
          "6567", "6065", "7326", "6677", "4751", "8629", "8732", "4310", "3968", "4592", "3758", "4818", "7061",
          "4765", "2388", "8627", "3823", "8936", "3720", "9443", "3724", "6532", "2178", "6047", "2318", "3859",
          "8437", "4350", "2330", "4304", "2477", "2337", "4564", "4974", "3825", "3657", "3245", "2149", "4563",
          "3672", "2135", "6160", "7045", "2403", "8942", "7037", "4741", "4776", "4437", "8912", "8462", "3900",
          "2752", "2928", "7717", "4331", "8426", "6565", "2701", "3827", "3981", "2350", "4314", "4831", "6660",
          "2371", "3384", "6046", "2183", "4316", "4579", "9325", "3841", "4303", "3685", "2126", "3925", "9204",
          "2338", "4797", "2369", "3667", "2415", "2766", "4841", "6661", "3060", "3343", "3150", "2377", "2446",
          "4288", "4427", "6177", "6094", "3184", "1430", "8941", "4786", "3736", "3911", "2158", "3233", "1446",
          "4880", "3319", "9427", "4753", "2190", "2413", "7049", "7035", "3730", "8943", "2677", "3632", "7772",
          "2687", "3324", "6552", "4425", "8783", "3627", "3689", "2347", "3990", "3668", "4395", "3793", "3445",
          "4788", "4593", "4838", "4308", "4813", "4764", "7589", "4875", "4309", "4488", "6786", "6072", "3780",
          "4335", "8922", "3745", "3768", "2478", "3383", "2404", "4476", "4281", "6555", "3792", "3756", "3328",
          "2342", "3346", "3230", "8888", "3351", "3755", "2386", "2191", "6574", "1400", "3786", "2144", "3042",
          "3311", "3767", "3993", "4572", "2397", "2326", "3764", "4791", "8767", "8711", "2798", "4815", "3809",
          "7041", "8728", "2448", "8947", "3716", "6232", "7076", "3770", "7046", "4747", "4305", "4300", "4387",
          "3835", "2454", "2489", "8903", "3842", "2355", "3832", "3994", "6627", "3491", "4385", "7157", "2321",
          "7036", "8704", "3350", "6697", "3776", "3787", "4347", "2345", "3772", "3482", "2323", "6059", "2463",
          "2695", "3798", "3629", "4320", "8423", "6088", "2175", "3813", "8735", "3747", "9445", "2980", "2447",
          "3812", "2468", "8924", "1408", "3932", "6563", "2160", "2138", "4567", "6054", "6556", "4330", "9418",
          "2460", "3674", "4446", "2393", "3715", "4487", "2712", "2732", "2128", "3633", "2432", "3329", "3037",
          "2495", "3796", "3261", "3797", "3811", "7071", "4840", "3064", "3359", "3778", "3498", "2461", "2720",
          "3452", "6619", "2471", "3457", "9270", "3810", "3821", "7072", "3808", "3775", "3558", "2588", "2392",
          "3815", "8771", "3334", "3858", "3373", "3322", "8798", "4582", "2159", "3783", "4483", "4479", "2356",
          "8948", "7063", "3765", "6096", "2196", "3831", "3415", "2484", "7077", "2494", "6071", "3845", "3043",
          "3377", "3620", "4321", "3074", "3061", "4583", "2122", "4477", "3917", "3843", "8410", "2491", "8945",
          "4587", "1436", "3467", "2316", "4777", "2140", "6093", "9378", "3838", "3991", "2450", "2444", "3300",
          "2451", "2361", "3330", "3653", "4322", "6198", "2379", "3744", "3692", "6533", "3661", "3746", "2121",
          "3850", "4809", "6836", "2148", "4794", "3714", "2931", "3179", "4287", "3781", "2459", "3856", "7777",
          "4478", "2706", "3749", "6064", "3679", "4485", "3655", "4438", "3773", "6553", "3071", "2177", "3252",
          "7047", "6562", "2464", "3090", "6031", "3722", "6087", "9514", "8769", "3623", "2493", "4598", "2788",
          "2427", "2978", "2884", "4749", "2370", "6172", "6030", "6026", "7172", "3913", "1712", "6080", "6578",
          "3646", "3565", "6081", "3664", "7782", "8914", "3538", "6739", "3387", "3665", "9419", "2492", "3985",
          "2497", "4779", "2453", "3966", "6067", "3044", "3237", "7725", "3541", "4585", "3622", "4384", "2929",
          "3634", "3853", "2721", "7148", "6726", "7776", "6079", "9279", "6029", "7774", "4334", "6191", "2485",
          "9424", "8890", "4302", "3496", "3652", "4382", "2132", "3802", "1429", "2363", "4762", "7320", "2418",
          "6769", "4449", "3691", "3915", "6181", "3697", "2748", "6535", "7064", "4424", "7311", "2665", "3264",
          "3929", "3998", "3390", "6040", "6049", "6045", "2430", "3276", "2411", "6063", "6027", "2385", "3259",
          "6037", "6039", "2134", "3928", "3251", "6095", "3645", "6256", "3325", "3092", "6048", "2479", "2120",
          "3906", "6033", "3323", "8715", "4575", "3082", "3836", "4588", "3242", "3969", "3696", "2423", "8940",
          "3063", "7779", "4830", "2438", "4697", "3180", "2154", "3830", "1435", "3393", "4394", "3484", "3171",
          "2373", "3469", "6558", "7080", "4771", "3669", "9262", "3247", "3416", "3769", "2930", "9446", "6721",
          "3731", "3789", "4597", "3960", "3777", "4817", "3366", "6187", "3782", "4763", "7034", "3922", "3918",
          "4978", "3987", "6551", "2880", "3818", "4344", "7833", "3824", "3686", "6090", "2352", "2724", "2970",
          "4814", "8789", "4480", "3760", "3937", "6077", "6778", "3031", "2751", "3135", "6084", "6239", "3989",
          "9423", "4576", "3996", "3358", "4289", "7191", "2155", "3639", "4293", "4435", "2150", "1383", "8996",
          "3057", "3175", "3073", "6192", "3475", "2303", "3454", "6538", "2409", "3807", "4586", "6670", "3682",
          "6573", "4591", "3656", "3999", "3223", "2467", "6085", "2410", "4792", "2136", "3239", "4352", "3902",
          "7192", "2130", "9272", "4381", "6025", "2133", "3658", "6075", "3267", "3687", "3936", "3984", "2656",
          "4744", "7060", "3479", "4357", "4484", "4829", "4571", "3826", "6052", "7038", "4584", "7829", "3550",
          "2193", "4821", "2681", "3464", "7074", "3094", "3542", "3133", "3912", "2429", "7185", "3931", "4443",
          "3177", "4346", "3788", "6732", "6579", "2586", "7803", "2462", "2142", "6550", "4422", "6078", "6561",
          "1401", "7187", "6082", "3545", "7847", "4441", "6161", "3739", "4594", "7059", "6069", "4393", "8909",
          "2486", "3695", "6050", "8774", "6531", "2165", "6577", "6194", "3093", "2314", "3140", "3967", "4313",
          "3195", "3660", "4436", "3486", "7078", "6175", "6549", "3814", "3785", "4599", "8929", "6659", "3920",
          "2315", "7183", "3399", "6557", "3275", "3138", "3228", "7033", "6597", "3740", "4773", "7068", "3690",
          "3698", "3181", "3235", "3474", "3241", "3134", "3908", "3963", "3916", "3680", "3979", "7069", "3654",
          "3962", "3914", "2425", "3034", "3751", "6263", "4833", "6200", "1449", "8734", "4431", "6092", "3280",
          "3248", "3901", "3851", "7323", "4327", "3624", "6190", "9416", "3742", "4766", "4565", "4429", "3995",
          "9467", "8787", "4845", "9444", "6698", "2399", "9421", "3694", "3905", "7066", "3547", "3085", "7169",
          "6255", "4825", "4239", "3930", "3927", "4756", "3186", "7044", "3688", "4290", "3137", "3784", "6176",
          "4486", "3662", "4448", "3986", "3559", "3224", "4240", "6034", "6537", "6180", "9517", "3316", "6253",
          "3923", "4442", "7043", "3185", "4482", "3681", "9376", "3641", "4388", "3907", "3356", "4445", "2127",
          "4280", "8885", "4827", "3274", "3326", "3791", "3732", "2440", "4355", "8991", "2725", "3829", "7707",
          "2420", "4795", "4336", "3394", "6560", "6185", "6672", "2437", "2757", "3182", "3347", "6545", "3939",
          "2782", "2743", "7836", "3970", "3372", "8925", "6070", "3067", "2976", "6580", "2458", "4839", "3854",
          "3054", "8998", "6541", "3556", "3904", "3976", "6829", "2769", "2710", "2667", "3489", "3727", "3909",
          "8997", "6259", "3753", "3557", "3344", "6261", "2334", "4566", "3625", "3712", "4444", "7676", "7039",
          "9519", "8946", "9425", "3840", "2926", "4787", "4391", "6099", "3935", "6193", "3846", "7853", "7217",
          "9450", "2763", "3021", "3678", "7674", "8938", "7683", "4450", "4389", "3089", "4356", "7067", "7828",
          "4398", "2424", "3540", "6572", "4380", "3049", "2406", "1431", "3734", "6554", "8898", "3961", "3046",
          "1382", "3497", "3983", "7708", "4434", "3849", "7849", "3083", "3933", "2124", "4573", "2391", "3032",
          "3666", "1711", "2488", "3926", "7835", "7062", "9386", "7671", "3367", "2981", "3997", "7685", "6196",
          "3236", "6058", "6616", "9381", "2317", "2465", "2776", "7837", "6668", "3353", "2167", "6264", "7748",
          "2137", "3934", "3131", "6173", "2351", "4925", "2483", "9266", "3163", "3163", "2652", "3477", "4317",
          "7824", "6734", "4351", "8944", "3762", "6731", "3397", "6750", "3146", "3379", "2475", "3065", "9271",
          "3349", "4421", "3053", "2166", "3362", "3079", "3375", "3189", "4439", "4789", "6790", "2179", "3352",
          "2304", "2428", "4397", "3174", "6164", "4440", "3143", "7709", "6777", "6036", "2758", "3386", "2162",
          "3844", "4237", "7057", "6544", "6656", "7806", "6260", "3165", "2499", "6696", "4447", "6195", "2340",
          "2796", "7813", "3723", "4475", "4301", "6548", "6634", "7325", "2180", "3790", "4770", "3566", "2164",
          "3196", "3710", "2693", "3801", "7649", "3921", "6032", "7818", "3800", "3080", "2435", "5704", "3804",
          "3419", "3299", "3077", "3418", "3446", "3771", "2705", "8935", "4570", "6038", "7838", "3294", "3848",
          "3385", "3244", "3036", "2795", "2143", "2145", "2408", "3977", "2402", "3066", "2431", "8919", "3048",
          "2123", "4332", "2186", "2182", "3910", "3030", "3649", "6051", "8993", "3822", "8992", "8893", "3965",
          "3628", "3988", "4386", "6539", "4390", "3847", "2375", "7048", "3370", "7830", "4931", "3170", "3317",
          "1729", "3562", "6662", "4822", "6062", "3047", "9428", "3193", "3058", "2169", "6635", "3040", "6575",
          "2481", "2777", "6667", "6086", "3172", "6199", "3852", "7042", "4772", "7073", "4369", "7050", "3020",
          "6657", "2139", "9264", "3490", "3376", "2490", "3816", "3075", "3440", "3096", "7314", "3091", "3297",
          "3221", "3794", "7810", "7807", "2151", "3561", "2405", "3803", "3940", "9375", "7812", "2395", "3837",
          "3992", "3243", "4428", "7805", "6188", "6630", "6638", "6184", "4971", "3494", "7749", "3041", "2487",
          "6156", "2172", "3070", "3381", "6568", "2362", "6694", "7804", "3677", "7058", "2882", "3033", "2176",
          "5699", "3187", "7808", "2789", "2152", "6519", "3035", "2449", "3733", "5742", "7079", "8937", "3260",
          "3371", "2927", "3277", "2198", "3763", "2445", "6658", "6636", "4798", "3293", "1450", "6074", "3495",
          "9466", "4241", "3560", "2496", "2376", "6044", "2300", "3766", "2173", "2480", "7826", "4595", "6061",
          "4238", "6254", "4396", "2434", "3097", "3644", "2228", "3671", "3190", "5724", "7823", "3192", "4842",
          "4952", "2157", "2436", "6257", "9385", "3799", "3435", "2469", "2820", "1433", "3444", "1439", "3361",
          "9379", "6163", "2675", "6640", "4420", "7816", "4926", "6159", "3839", "3374", "3439", "6166", "2163",
          "4976", "8709", "3461", "7800", "2185", "3027", "8699", "3268", "7827", "3974", "2589", "3052", "3388",
          "4242", "7781", "7760", "3670", "3095", "3683", "3136", "7682", "3441", "3364", "3068", "7213", "3169",
          "6626", "2227", "3147", "3895", "6258", "8697", "8187", "4124", "3537", "6060", "2156", "3437", "7834",
          "7773", "5758", "3024", "4244", "4243", "6158", "3160", "7819", "6248", "9029", "3173", "3161", "6182",
          "6543", "7809", "9417", "6618", "6233", "5456", "7175", "7678", "3250", "8708", "6637"]:
    try:
        print(i)
        value = [str(i)]
        url = "https://minkabu.jp/stock/" + str(i) + "/ipo"
        dfs = pd.read_html(url)
        # print(len(dfs))
        table = dfs[3]

        for a in table.values.tolist():
            for b in a:
                value.append(b)

        Result = pd.DataFrame([value])

        Result.to_csv(r"C:\\Users\Ray94\OneDrive\Research\PHD\Research\data\japan_IPO\基本情報\\主要株主_Yu_20210724_Ver1.0.csv",
                      mode='a',
                      index=False, header=None, encoding="utf-8_sig")
        time.sleep(20)

    except Exception as e:

        Error = pd.DataFrame([[str(i), "データなし"]])
        print(e)
        Error.to_csv(
            r"C:\\Users\Ray94\OneDrive\Research\PHD\Research\data\japan_IPO\基本情報\\主要株主_Yu_20210724_Ver1.0.csv",
            mode='a',
            index=False, header=None,
            encoding="utf-8_sig")
        pass
